README

SampleSpecificIsoforms.py is a custom Python script for identifying tissue-specific transcript
isoforms from output files generated by ESPRESSO after processing 1D cDNA sequencing datasets
for 30 human tissues (as part of the ESPRESSO manuscript). In brief, our script uses the following
approach to prioritize transcript isoforms as being tissue-specific:

1. For each gene, generate an m-by-30 contigency table comprised of read counts (rounded to the 
   nearest integer) for m identified isoforms across the 30 tissues:
   * Compute gene expression levels in each tissue as the sum of read counts over all isoforms of
     the gene.
   * Ignore genes with only one identified transcript isoform or are only expressed in only one
     tissue. Omit tissues from contingency table if gene of interest is not expressed in those
     tissues.
2. Run a chi-square test of homogeneity (FDR < threshold) on the contingency table to identify
   genes in which isoform proportions are not homogeneous across the considered tissues.
   * Apply Cohen's w formula to determine the minimum sample size for running our chi-square test
     (see Methods and Materials in ESPRESSO paper)
3. Focus on genes prioritized by chi-square test with FDR < threshold and run a post-hoc test to
   identify tissue-isoform pairs in which the isoform proportion in the given tissue is 
   significantly higher than the overall isoform proportion across all tissues (i.e., sum of read 
   counts of the isoform over all tissues divided by the sum of read counts for all isoforms 
   across all tissues)
   * Post-hoc test was a one-tailed binomial test with FDR < threshold 

SampleSpecificIsoforms.py was developed and tested using Python 3.8.10 and has the following
dependencies:

* numpy (v1.19.4)
* pandas (v1.1.4)
* scipy (v1.5.4)
* statsmodels (v0.12.2) 

Usage information for running SampleSpecificIsoforms.py is detailed as follows:

```
python SampleSpecificIsoforms.py [-h] -i /path/to/ESPRESSO/isoform/abundance/matrix \
    -t <number of worker threads> -c <FDR threshold> -o /path/to/output/file

script arguments:
    -h, --help                                          show this message and exit

    -i /path/to/ESPRESSO/isoform/abundance/matrix       path to tsv file generated by ESPRESSO
                                                        summarizing all detected transcript 
                                                        isoforms across samples and their
                                                        assigned read counts (*_N2_R0_abundance.esp)

    -t <number of worker threads>                       number of worker threads (integer)

    -c <FDR threshold>                                  FDR threshold for calling transcript
                                                        isoforms as tissue-specific (float between
                                                        0 and 1)

    -o /path/to/output/file                             path to tsv file generated by script
                                                        summarizing all transcript isoforms
                                                        prioritized as being tissue-specific
```

Our script will generate a tsv file summarizing all transcript isoforms prioritized as being
tissue-specific at the specified FDR threshold. Each line of the tsv file has the following 
output fields:

* Field 1: Gene ID corresponding to gene of a tissue-specific isoform
* Field 2: Transcript ID of the tissue-specific isoform
* Field 3: Sample name of the corresponding tissue
* Field 4: Read counts assigned by ESPRESSO to tissue-specific isoform in given tissue
* Field 5: Global isoform proportion (sum of read counts of the isoform over all tissues
           divided by the sum of read counts for all isoforms across all tissues)
* Field 6: Isoform proportion in the given tissue
* Field 7: Raw p-value for tissue-specificity
* Field 8: FDR-adjusted p-value for tissue-specificity
